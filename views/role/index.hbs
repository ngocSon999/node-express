<div class="container-fluid">
    <div class="row">
        <div class="col-12">
            <div class="card">
                <div class="card-header">
                    <h3 class="card-title">Role Management</h3>
                    <div class="card-tools">
                        <a href="{{ routes 'roleCreate'}}" class="btn btn-primary">Create New Role</a>
                    </div>
                </div>
                <div class="card-body">
                    <table class="table table-bordered table-striped">
                        <thead>
                            <tr>
                                <th>ID</th>
                                <th>Name</th>
                                <th>Description</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="roleTableBody">
                            <!-- Role data will be loaded here dynamically -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    // Fetch and display roles
    async function loadRoles() {
        try {
            const response = await fetch('/api/v1/role');
            const data = await response.json();
            const tableBody = document.getElementById('roleTableBody');
            tableBody.innerHTML = '';

            data.data.forEach(role => {
                const row = `
                    <tr>
                        <td>${role.id}</td>
                        <td>${role.name}</td>
                        <td>${role.description || ''}</td>
                        <td>
                            <a href="/admin/role/edit/${role.id}" class="btn btn-sm btn-info">Edit</a>
                            <button onclick="deleteRole(${role.id})" class="btn btn-sm btn-danger">Delete</button>
                        </td>
                    </tr>
                `;
                tableBody.innerHTML += row;
            });
        } catch (error) {
            console.error('Error loading roles:', error);
        }
    }

    // Delete role
    async function deleteRole(id) {
        if (confirm('Are you sure you want to delete this role?')) {
            try {
                const response = await fetch(`/api/v1/role/${id}`, {
                    method: 'DELETE'
                });
                const data = await response.json();
                if (data.success) {
                    showAlert('Role deleted successfully');
                    loadRoles();
                } else {
                    showAlert('Error deleting role');
                }
            } catch (error) {
                console.error('Error deleting role:', error);
                showAlert('Error deleting role');
            }
        }
    }

    // Load roles when page loads
    document.addEventListener('DOMContentLoaded', loadRoles);
</script>